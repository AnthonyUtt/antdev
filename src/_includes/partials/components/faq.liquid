<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {% for item in faq %}
    {
      "@type": "Question",
      "name": "{{ item.question }}",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "{{ item.answer | strip_html }}"
      }
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>
<section class="faq">
  <h2 class="faq__title">frequently asked questions</h2>
  <div class="faq__items">
    {% for item in faq %}
    <div class="faq__item">
      <button class="faq__question" type="button" aria-expanded="false" data-umami-event="faq-open" data-umami-event-question="{{ item.question }}">
        {{ item.question }}
        <span class="faq__toggle" aria-hidden="true"></span>
      </button>
      <div class="faq__answer">
        <p>{{ item.answer }}</p>
      </div>
    </div>
    {% endfor %}
  </div>
</section>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const faqItems = document.querySelectorAll('.faq__item');

  faqItems.forEach(item => {
    const question = item.querySelector('.faq__question');
    const answer = item.querySelector('.faq__answer');

    question.addEventListener('click', () => {
      const isOpen = question.getAttribute('aria-expanded') === 'true';

      // Close all other items
      faqItems.forEach(otherItem => {
        const otherQuestion = otherItem.querySelector('.faq__question');
        const otherAnswer = otherItem.querySelector('.faq__answer');
        otherQuestion.setAttribute('aria-expanded', 'false');
        otherAnswer.style.maxHeight = null;
      });

      // Toggle current item
      if (!isOpen) {
        question.setAttribute('aria-expanded', 'true');
        answer.style.maxHeight = answer.scrollHeight + 'px';
      }
    });
  });
});
</script>
